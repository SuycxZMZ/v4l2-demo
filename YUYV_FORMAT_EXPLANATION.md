# YUYV 格式详解

## 什么是 YUYV？

YUYV（也称为 YUY2 或 YUV 4:2:2）是一种未压缩的像素格式，广泛用于视频捕获和处理。

## YUYV 格式特点

### 1. 颜色空间
- **Y**: 亮度（Luminance）分量，表示图像的明暗程度
- **U**: 色度（Chrominance）蓝色分量（Cb）
- **V**: 色度（Chrominance）红色分量（Cr）

### 2. 采样方式：4:2:2
- **4:2:2** 表示：
  - 每 4 个像素采样 4 个 Y（亮度）值
  - 每 4 个像素采样 2 个 U（色度）值
  - 每 4 个像素采样 2 个 V（色度）值

### 3. 数据排列
YUYV 格式中，每 2 个像素占用 4 个字节：
```
像素1: Y0 U0
像素2: Y1 V0
像素3: Y2 U2
像素4: Y3 V2
...
```

字节顺序：`Y0 U0 Y1 V0 Y2 U2 Y3 V2 ...`

### 4. 存储大小计算
对于 640x480 分辨率的图像：
- 总像素数：640 × 480 = 307,200 像素
- YUYV 格式：每 2 个像素 = 4 字节
- 总大小：307,200 ÷ 2 × 4 = **614,400 字节** (约 600 KB)

## 为什么保存为 .raw 文件？

### .raw 文件的含义
`.raw` 文件是**原始二进制数据文件**，包含：
- 未压缩的像素数据
- 没有文件头、元数据或压缩信息
- 直接存储 YUYV 格式的字节流

### 文件内容
保存的 `.raw` 文件包含：
1. **纯二进制数据**：直接是摄像头输出的 YUYV 格式字节流
2. **无格式信息**：文件本身不包含宽度、高度、格式等元数据
3. **需要外部工具查看**：不能直接用图片查看器打开

## 如何查看 .raw 文件？

### 方法 1: 使用 FFmpeg 转换
```bash
# 将 YUYV .raw 文件转换为 PNG
ffmpeg -f rawvideo -pixel_format yuyv422 -video_size 640x480 -i output/frame_000.raw -frames:v 1 output/frame_000.png

# 或转换为 JPEG
ffmpeg -f rawvideo -pixel_format yuyv422 -video_size 640x480 -i output/frame_000.raw -frames:v 1 output/frame_000.jpg
```

### 方法 2: 使用 Python 脚本
```python
import numpy as np
from PIL import Image

# 读取 .raw 文件
width, height = 640, 480
with open('output/frame_000.raw', 'rb') as f:
    raw_data = f.read()

# 转换为 numpy 数组
yuyv = np.frombuffer(raw_data, dtype=np.uint8).reshape((height, width * 2))

# 提取 Y, U, V 分量
y = yuyv[:, 0::2]  # 偶数位置是 Y
u = yuyv[:, 1::4]  # 每 4 个字节的第 2 个是 U
v = yuyv[:, 3::4]  # 每 4 个字节的第 4 个是 V

# 转换为 RGB（简化版本，实际需要更复杂的转换）
# ... YUV 到 RGB 转换代码 ...
```

### 方法 3: 使用 GIMP
1. 打开 GIMP
2. 文件 → 打开
3. 选择 `.raw` 文件
4. 设置：
   - 图像类型：RGB
   - 宽度：640
   - 高度：480
   - 偏移：0
   - 像素格式：需要手动指定或使用插件

## YUYV vs 其他格式

| 格式 | 压缩 | 文件大小 (640x480) | 质量 | 用途 |
|------|------|-------------------|------|------|
| YUYV | 无 | ~600 KB | 高 | 视频捕获、实时处理 |
| UYVY | 无 | ~600 KB | 高 | 类似 YUYV，字节顺序不同 |
| MJPEG | 有 | ~50-200 KB | 中-高 | 视频流、存储 |
| RGB24 | 无 | ~900 KB | 高 | 图像处理、显示 |

## 为什么选择 YUYV？

1. **实时性好**：无需压缩/解压，处理速度快
2. **质量高**：未压缩，保持原始画质
3. **兼容性强**：大多数摄像头都支持
4. **处理方便**：可以直接进行 YUV 空间的处理（如亮度调整）

## 注意事项

1. **文件大小**：YUYV 格式文件较大，不适合长期存储大量帧
2. **查看工具**：需要专门的工具才能查看 .raw 文件
3. **格式转换**：如果需要查看，需要转换为 RGB 或 JPEG 格式

## 相关格式对比

### YUYV vs UYVY
- **YUYV**: `Y U Y V` 字节顺序
- **UYVY**: `U Y V Y` 字节顺序
- 两者数据量相同，只是字节排列顺序不同

### YUYV vs YUV420
- **YUYV (4:2:2)**: 水平方向色度采样率 50%
- **YUV420 (4:2:0)**: 水平和垂直方向色度采样率都是 50%
- YUV420 文件更小，但质量略低



